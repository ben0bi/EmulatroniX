<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" />
	<title>EmulatroniX</title>
	<link rel="stylesheet" type="text/css" href="css/base.css">
</head>
<body>
	<div id="wrapper">
		<div id="pixiscreen"></div>
	</div>
	
	<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
	<script src="https://pixijs.download/v4.5.2/pixi.min.js"></script>
	<script src="http://cdn.rawgit.com/ben0bi/RUNPIXI.js/v0.6.4/RUNPIXI/RUNPIXI.js"></script>
	
	<script>
		function mainLoop() 
		{
		}

		var browserBackgroundColor = 0x111133; // also used for the emulator border.
		var emuBackgroundColor = 0x000000;
		var emuBorderWidth = 10; // better cover more than less space.
		
		function drawPixel(x,y, color,g)
		{
			g.beginFill(color, 1.0);
				g.drawRect(x+emuBorderWidth,y+emuBorderWidth,2,2);
			g.endFill();
		}
		
		$(document).ready(function() 
		{
			RUNPIXI.initialize('pixiscreen', mainLoop, browserBackgroundColor);
			RUNPIXI.PIXELATED(); // use this for pixel perfect rendering.
			
// NOT EMULATOR SPECIFIC
			// create the pixel texture.
			var gpix = new PIXI.Graphics();
			gpix.beginFill(0xFFFFFF, 1.0);
				gpix.drawRect(0,0,2,2);
			gpix.endFill();
			
			var pixelTex = gpix.generateCanvasTexture();
// ENDOF
			
			// standard VGA :)
			var emuWidth = 320;
			var emuHeight = 240;
			
			// the draw width is double the emu width.
			var drawWidth = emuWidth*2;
			var drawHeight = emuHeight*2;
			
			// create the background texture.
			var gbg = new PIXI.Graphics();
			gbg.beginFill(emuBackgroundColor, 1.0);
				gbg.drawRect(emuBorderWidth,emuBorderWidth,drawWidth,drawHeight); // add border width to position to draw border later.
			gbg.endFill();
			
			
			// draw borders to cover pixels which may be overlap the emulator screen.
/*			g.beginFill(browserBackgroundColor, 1.0);
				g.drawRect(0,0,drawWidth+emuBorderWidth*2,emuBorderWidth); // from top right to top left.
				g.drawRect(0,0,emuBorderWidth,drawHeight+emuBorderWidth*2); // from top right to bottom right.
				g.drawRect(drawWidth+emuBorderWidth,0,emuBorderWidth,drawHeight+emuBorderWidth*2); // from top left to bottom left.
				g.drawRect(0,drawHeight+emuBorderWidth,drawWidth+emuBorderWidth*2,emuBorderWidth); // from bottom right to bottom left.
			g.endFill();
*/		
			// generate a texture from that stuff
			var backgroundTex = gbg.generateCanvasTexture();

			// get the screen size to center the sprite.
			var realScreenWidth = RUNPIXI.getScreenSize().w;
			var realScreenHeight = RUNPIXI.getScreenSize().h;

			var backgroundsprite = new PIXI.Sprite(backgroundTex);
			
			// the container holds the whole emulator screen.
			var container = new PIXI.Container();
			container.addChild(backgroundsprite);

			
			var pixel = new PIXI.Sprite(pixelTex);
			var pixel2 = new PIXI.Sprite(pixelTex);
			
			
		/*	container.scale.x=0.5;
			container.scale.y=0.5;
*/

			// center the container AFTER scaling.
			container.x = realScreenWidth*0.5-container.width*0.5;
			container.y = realScreenHeight*0.5-container.height*0.5;

			pixel2.tint=0xFF0000;
			
			pixel.x = 10;
			pixel.y = 10;
			
			pixel2.x=20;
			pixel2.y=20;
			container.addChild(pixel);
			container.addChild(pixel2);
			
			RSTAGE().addChild(container);
			
			pixel.tint=0x0000FF;

			console.log("Ready.");
		});
	</script>
</body>
</html>